## ğŸ“¦ CommonJS (CJS) vs ES6 Modules (MJS) in Node.js

---

### ğŸ” `this` Behavior

```js
// In ES6 Module
console.log(this); // âŒ undefined (strict mode enabled by default)

// In CommonJS Module
console.log(this); // âœ… {} (refers to module.exports object)
```

---

### ğŸ“Œ Hoisting

- **CommonJS (CJS)**: âŒ Not hoisted â€” `require` statements behave like regular functions.
- **ES6 Modules (MJS)**: âœ… Imports are **hoisted** â€” meaning they are moved to the top at compile time.

---

### ğŸ“„ Example Code

#### âœ… ES6 Module Example

> Use `.mjs` extension or `"type": "module"` in `package.json`

```js
// math.mjs
export function add(a, b) {
  return a + b;
}
export function sub(a, b) {
  return a - b;
}

// app.mjs
import { add, sub } from './math.mjs';
console.log(add(5, 3)); // 8
console.log(sub(5, 3)); // 2
```

#### âœ… CommonJS Module Example

```js
// math.js
function add(a, b) {
  return a + b;
}
function sub(a, b) {
  return a - b;
}
module.exports = { add, sub };

// app.js
const { add, sub } = require('./math.js');
console.log(add(5, 3)); // 8
console.log(sub(5, 3)); // 2
```

---

### ğŸ“Š Feature Comparison

| Feature | ğŸ§© CommonJS (CJS) | ğŸš€ ES6 Module (MJS) |
|--------|------------------|--------------------|
| ğŸ”§ Syntax | `require()`, `module.exports` | `import`, `export` |
| âš™ï¸ Execution | Synchronous (Blocking) | Asynchronous (Non-blocking) |
| ğŸ“¦ Load Time | Runtime (Dynamic) | Compile Time (Static) |
| ğŸ§  Tree Shaking | âŒ Not supported | âœ… Supported |
| ğŸ“„ File Extension | `.js` | `.mjs` or `.js` with `"type": "module"` |
| ğŸ§­ Scope | Own local scope | Strict mode by default |
| â³ Top-Level `await` | âŒ Not supported | âœ… Supported |
| ğŸ” Dynamic Import | âœ… `require()` | âœ… `import()` function |
| ğŸ“ `__filename`, `__dirname` | âœ… Available | âŒ Use `import.meta.url` instead |
| ğŸ§ª Use in Browser | âŒ Not directly | âœ… Yes |
| ğŸ”„ Named Export | âš ï¸ Limited | âœ… Full Support |
| ğŸ”ƒ Default Export | âœ… Yes | âœ… Yes |

---

### ğŸ§  Note on `import.meta`

In ES6 modules:
```js
console.log(import.meta.url); // Full file path (like __filename)
```

To simulate `__dirname`:
```js
import { fileURLToPath } from 'url';
import { dirname } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);
```

---

### ğŸ“ Summary

- Use **CommonJS** for legacy Node.js support.
- Use **ES6 Modules** for modern, optimized, and browser-compatible code.
- Prefer **MJS** if you're targeting ESM features like top-level await, tree-shaking, or static analysis.